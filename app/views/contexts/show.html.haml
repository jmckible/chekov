%h2= link_to @context.name, [:edit, @context]

%p= @context.description

= form_tag @context, :method=>:get do
  %p
    %select{name: 'user_id'}
      %option{value: ''} Everyone
      - User.all.each do |u|
        - options = {value: u.id}
        - options[:selected] = 'selected' if u == @user
        %option{options}= u.name
    = submit_tag 'Show'

%table.data
  %tr
    %th Story
    - @context.browsers.each do |browser|
      %th= browser
    %th Blended
  - @context.stories.each do |story|
    %tr
      %td= link_to story.name, [@context, story]
      - @context.browsers.each do |browser|
        %td{style: "background-color: #{colorize story.passed_for(browser, @user)}", class: story.coverage(browser)}= link_to story.passed_for(browser, @user), new_context_story_suite_path(@context, story, 'suite[browser]'=>browser)
      %td{style: "background-color: #{colorize story.passed_blended(@user)}", class: "#{story.coverage} strong"}= story.passed_blended(@user)
  %tr.strong
    %td Total
    - @context.browsers.each do |browser|
      %td{style: "background-color: #{colorize @context.passed_for(browser, @user)}", class: @context.coverage(browser)}= @context.passed_for browser, @user
    %td{style: "background-color: #{colorize @context.passed_blended(@user)}", class: @context.coverage}= @context.passed_blended(@user)
    
%p= link_to 'New Story', new_context_story_path(@context)